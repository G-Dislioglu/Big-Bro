# Railway Configuration for Big-Bro Monorepo
# Ensures consistent builds and deployments

$schema = "https://railway.com/railway.schema.json"

[build]
# Install all dependencies (root + workspaces) and build client
builder = "RAILPACK"
watchPatterns = ["server/**", "client/**", "railway.toml", "nixpacks.toml", "package.json"]
buildCommand = "npm ci && npm run build"

[deploy]
# Start the server from root
startCommand = "npm start"
# Healthcheck endpoint for stable deployments
healthcheckPath = "/api/health"
healthcheckTimeout = 30
# Restart policy
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 3
